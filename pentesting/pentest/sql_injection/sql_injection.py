import requests


def check_sql(url):
    sql_queries = [
        "SELECT * FROM users WHERE username = '' OR 1=1; --",
        "SELECT * FROM users WHERE username = 'admin' AND password LIKE 'a%'; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT 1,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT @@VERSION,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT NULL,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' AND SUBSTR(password, 1, 1) = 'a'; --",
    ]
    logMass = []

    for command in sql_queries:
        print("команда үшін пентест басталды" + command)
        response = requests.get(url + "?param=" + command)

        if "SQL" in response.text:
            print("Осалдық табылды: ", command)
            logMass.append({"start": "Команда үшін пентест басталды " + command,
                            "text": "Осалдық табылды: " + command})
        else:
            logMass.append({"start": "Команда үшін пентест басталды " + command,
                            "text": "Сынақ сәтті өтті, осалдықтар жоқ.............." + command})
    return logMass