import requests


def check_sql(url):
    # Список тестовых SQL-запросов для проверки на SQL инъекции
    sql_queries = [
        "SELECT * FROM users WHERE username = '' OR 1=1; --",
        "SELECT * FROM users WHERE username = 'admin' AND password LIKE 'a%'; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT 1,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT @@VERSION,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' UNION SELECT NULL,2,3; --",
        "SELECT * FROM users WHERE username = 'admin' AND SUBSTR(password, 1, 1) = 'a'; --",
    ]
    logMass = []

    for command in sql_queries:
        print("pentest начат для команды" + command)
        # Отправляем запрос GET на сайт с параметром, содержащим команду XSS
        response = requests.get(url + "?param=" + command)

        # Если на странице есть небезопасный вывод, выводим сообщение об ошибке
        if "SQL" in response.text:
            print("Уязвимость найдена: ", command)
            logMass.append({"start": "pentest начат для команды " + command,
                            "text": "Уязвимость найдена: " + command})
        else:
            logMass.append({"start": "pentest начат для команды " + command,
                            "text": "Петест проиден успешно уязвимрстей нет.............." + command})
    return logMass